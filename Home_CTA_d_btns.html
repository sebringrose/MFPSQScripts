<!-- 1. Get genre value from #genre-select on page -->
<!-- 2. Define selectFilm function which requests FlowPlayer middleware API with duration and genre params -->
<!-- 3. Attach selectFilm fcn to custom buttons with duration param value set for each button -->

<script>
    window.getGenre = () => document.querySelector("#genre-select").value;

    window.selectFilm = (duration) => fetch(`https://flowplayer-middleware.azurewebsites.net/api/getVideo?code=71QIkhIZbREwZek4nRNjIjSsWJcu7GAbKncFKnz30JGviBDCxokuog%3D%3D&tags=${duration},${getGenre()}`)
        .then(response => response.json())
        .then(films => {
            if (!films[0]) return alert("No films matching genre and duration found! Please try different options.")
            const flowPlayerCDN = "https://cdn.flowplayer.com/25560ea8-a64d-4d29-ba98-b82eb8c82e17/"
            const film = films[Math.floor(Math.random()*films.length)]
            window.location.href = `/player?id=${encodeURIComponent(film.name)}&t=${duration}${getGenre() ? ',' + getGenre() : ''}`
        })
</script>
<div style="display: flex; flex-wrap: wrap; justify-content: space-between; max-width: 1000px;">
    <button class="empire-custom-button" onClick="selectFilm('5 minutes')">
        5 minutes
    </button>
    <button class="empire-custom-button" onClick="selectFilm('10 minutes')">
        10 minutes
    </button>
    <button class="empire-custom-button" onClick="selectFilm('20 minutes')">
        20 minutes
    </button>
</div>